# 出勤紀錄功能改善規格 (Attendance Record Enhancement Specification)

## 1. 功能概述 (Overview)

改善電子交接本系統中的出勤記錄功能，讓正社員 (Regular) 和契約社員 (Contract) 的記錄能夠同時呈現在同一個輸入介面上，不需要使用下拉式選單來區分兩種職類。此功能將簡化用戶操作流程，提升數據輸入效率。

## 2. 使用者場景與測試 (User Scenarios & Testing)

### 主要場景
- **場景1**: 用戶填寫出勤記錄
  - 用戶進入出勤記錄頁面
  - 在同一個介面上看到正社員和契約社員的輸入欄位
  - 可以同時填寫兩類別的出勤資料（定員、出勤、欠勤、理由）
  - 不需要切換或選擇職類別

- **場景2**: 用戶查看歷史出勤記錄
  - 用戶查看過去的出勤記錄
  - 同時顯示正社員和契約社員的數據
  - 數據按類別清楚區分顯示

### 測試案例
- 驗證用戶在同一介面上可以輸入正社員和契約社員的出勤數據
- 驗證數據正確保存並可正確檢索
- 驗證界面清晰區分正社員和契約社員的欄位
- 驗證歷史數據正確顯示

## 3. 功能需求 (Functional Requirements)

### FR1: 同時顯示職類別輸入介面
- 系統應在同一個介面上同時顯示正社員 (Regular) 和契約社員 (Contract) 的出勤記錄輸入欄位
- 不應使用下拉式選單來切換職類別
- 每個職類別應有自己的定員 (Scheduled)、出勤 (Present)、欠勤 (Absent)、理由 (Reason) 欄位

### FR2: 數據輸入功能
- 用戶應能夠獨立輸入正社員和契約社員的出勤數據
- 應提供驗證以確保出勤人數加上欠勤人數等於定員人數（除非有特殊情況）
- 應記錄每個職類別的理由說明

### FR3: 數據保存與檢索
- 系統應正確保存正社員和契約社員的出勤記錄
- 數據應正確關聯到對應的日報表
- 應支援歷史出勤記錄的檢視

### FR4: 介面設計
- 介面應清楚區分正社員和契約社員的輸入區域
- 欄位標籤應明確標示職類別
- 應提供足夠的空間容納兩種職類別的數據

### FR5: 數據驗證
- 系統應驗證輸入的數字為有效數值
- 應檢查邏輯合理性（例如出勤和欠勤人數不超過定員）
- 應確保日期格式正確

## 4. 非功能性需求 (Non-Functional Requirements)

### NFR1: 可用性 (Usability)
- 介面應直觀易用，用戶無需額外培訓即可操作
- 欄位標籤應清晰易懂
- 錛衝操作錯誤應有適當的反饋

### NFR2: 效能 (Performance)
- 頁面載入時間應小於 2 秒
- 數據保存操作應在 1 秒內完成
- 數據檢索應在 3 秒內完成（即使大量歷史數據）

### NFR3: 可靠性 (Reliability)
- 數據保存應具有事務特性，確保數據一致性
- 系統應防止數據損壞或遺失

## 10. 報表互動需求 (Report Interaction)

### FR6: 出勤報表雙擊操作
- 用戶在出勤報表中雙擊「明細列」時，系統應開啟可編輯對話框，允許更新定員/出勤/欠勤/理由並提供刪除按鈕
- 雙擊彙總列時僅顯示資料內容，不應提供編輯或刪除功能
- 更新或刪除成功後應重新載入報表並反映最新數據

## 5. 成功標準 (Success Criteria)

- [ ] 用戶可以在同一介面上同時輸入正社員和契約社員的出勤記錄
- [ ] 系統正確保存兩類員工的出勤數據
- [ ] 介面回應時間小於 500 毫秒
- [ ] 驗證失敗時即時阻止提交並顯示清晰錯誤訊息
- [ ] 數據保存成功率達 100%
- [ ] 用戶操作完成時間比原先減少 30%
- [ ] 用戶滿意度達到 90% 以上

## 6. 關鍵實體 (Key Entities)

- **出勤記錄 (Attendance Record)**：包含 ID、報表 ID、職類別、定員數、出勤數、缺勤數、原因、創建時間等屬性
- **日報表 (Daily Report)**：包含日期、班別、區域等屬性，與出勤記錄關聯

## 7. 依賴與假設 (Dependencies & Assumptions)

### 依賴
- 系統現有的日報表功能
- 系統現有的出勤記錄功能
- 前端界面組件架構

### 假設
- 現有的數據庫結構可支援新的功能需求
- 用戶熟悉基本的數據輸入操作
- 系統現有的驗證機制可以擴展

## 8. 邊緣案例 (Edge Cases)

- 當某一職類別的員工數為零時，系統應正確處理
- 當輸入數據不符合邏輯時（如出勤人數大於定員），系統應顯示適當錯誤訊息
- 在低頻寬環境下，界面應提供適當的載入指示
- 當系統發生錯誤時，不應導致數據遺失

## 9. 已澄清問題 (Clarifications)

### 2025-11-25 會議決議
- **Q**: 數據驗證應達到什麼級別？
  - **A**: 必須符合邏輯（出勤+缺勤≤定員），這是基本數據完整性要求
- **Q**: 介面設計應如何處理？
  - **A**: 保持與現有介面設計風格一致，確保用戶體驗的連續性
- **Q**: 語言資源緩存策略如何實施？
  - **A**: 使用瀏覽器本地存儲進行語言資源緩存，平衡性能和持久性
