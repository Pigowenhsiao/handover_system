# 電子交接本系統功能規格 (Electronic Handover System Feature Specification)

## 1. 功能概述 (Overview)

本系統為單機桌面應用程式（Tkinter），支援中/英/日語切換，提供日報填寫、出勤記錄、設備異常、異常批次、總結統計、異常歷史查詢、Delay List 與 Summary Actual 匯入/上傳，以及管理功能。所有資料儲存在本機 SQLite，不依賴網路服務。

## 2. 使用者場景與測試 (User Scenarios & Testing)

### 主要場景
- **場景1**: 使用者登入系統並切換語言
  - 登入畫面可切換語言，切換後介面即時更新
  - 登入成功後進入主視窗，狀態與導航權限更新

- **場景2**: 使用者建立日報表（需先儲存基本資訊）
  - 在日報表頁面選擇日期、班別與區域（日期使用日曆選擇）
  - 儲存基本資訊後，其他功能頁面解除鎖定
  - 同日期+班別+區域將覆寫同一筆日報

- **場景3**: 使用者填寫出勤/設備/批次
  - 出勤同頁輸入正職/契約定員、出勤、欠勤與理由
  - 設備異常與批次異常可新增多筆記錄並保存

- **場景4**: 使用者查詢總結與異常歷史
  - 總結頁提供出勤統計表與圖表（日期區間預設本月 1 號到今天）
  - 異常歷史頁提供設備異常與批次異常雙表格，可依日期區間與班別/區域篩選

- **場景5**: 管理員維護資料
  - 管理員可管理使用者、翻譯資源、班別/區域與系統設定

### 測試重點
- 語言切換即時更新，介面標示完整且不出錯
- 日報基本資訊未儲存時，其他功能頁不可操作
- 同日期+班別+區域覆寫同一筆日報（出勤覆寫、設備/批次累加）
- 總結與異常歷史日期區間預設為當月 1 號到今天
- 異常歷史可依班別/區域篩選

## 3. 功能需求 (Functional Requirements)

### FR1: 語言切換
- 系統應支援日文、中文、英文三種語言
- 語言切換後介面文字立即更新
- 語言切換應維持於本次使用會話內

### FR2: 使用者認證
- 系統應提供登入介面並驗證帳號密碼
- 密碼需使用安全雜湊（bcrypt）儲存與驗證
- 管理員與一般使用者權限需區分

### FR3: 日報表與基本資訊門檻
- 日報表包含日期、班別、區域與摘要欄位
- 使用者需先儲存基本資訊才能操作其他功能頁面
- 同日期+班別+區域視為同一筆日報並覆寫

### FR4: 出勤記錄
- 正職與契約同頁輸入定員、出勤、欠勤與理由
- 出勤資料與日報表關聯保存

### FR5: 設備異常
- 記錄設備號碼、異常內容、發生時刻、影響數量、對應內容與圖片路徑（可選）
- 設備異常與日報表關聯保存

### FR6: 異常批次
- 記錄批號、異常內容、處置狀況與特記事項
- 批次異常與日報表關聯保存

### FR7: 管理功能
- 管理員可管理使用者與翻譯資源
- 管理員可新增/更新/刪除班別與區域
- 系統設定可保存備份間隔

### FR8: 總結（出勤統計）
- 提供日期區間查詢（預設本月 1 號到今天）
- 顯示出勤統計表（日期/區域/填寫者/正職/契約/備註）
- 顯示出勤率折線圖與出勤人數堆疊柱狀圖

### FR9: 異常歷史查詢
- 提供日期區間查詢（預設本月 1 號到今天）
- 支援班別/區域篩選
- 以表格顯示設備異常與批次異常的完整輸入細節

### FR10: Delay List / Summary Actual
- 支援 Excel 匯入 → 暫存 → 上傳流程
- 可依日期範圍查詢與編輯

## 4. 非功能性需求 (Non-Functional Requirements)

### NFR1: 效能
- 語言切換時間 < 500ms
- 日報保存與載入 < 1 秒

### NFR2: 可用性
- 介面流程清楚，登入後可依導覽操作
- 表單與表格提供清楚的標題與提示

### NFR3: 可靠性
- 語言切換不應造成崩潰或資料遺失
- 缺少翻譯時應回退預設文字

### NFR4: 安全性
- 密碼使用 bcrypt 雜湊
- 管理功能僅限管理員操作

## 5. 成功標準 (Success Criteria)

- [ ] 日報基本資訊未儲存時，其他頁面不可操作
- [ ] 總結與異常歷史日期預設為當月 1 號到今天
- [ ] 語言切換後所有介面元素即時更新
- [ ] 出勤、設備、批次可正確保存並與日報關聯
- [ ] 管理員可維護使用者、班別與區域

## 6. 關鍵實體 (Key Entities)

- **使用者 (User)**：使用者名稱、密碼雜湊、角色
- **日報表 (Daily Report)**：日期、班別、區域、作者與摘要欄位
- **出勤記錄 (Attendance Entry)**：正職/契約出勤資料
- **設備異常記錄 (Equipment Log)**：設備異常詳細資訊
- **異常批次記錄 (Lot Log)**：批次異常詳細資訊

## 7. 依賴與假設 (Dependencies & Assumptions)

### 依賴
- SQLite 資料庫（本機）
- Python 3.9+ 與 Tkinter

### 假設
- 使用者具備基本電腦操作能力
- 系統離線可用

## 8. 邊緣案例 (Edge Cases)

- 語言切換時缺翻譯應回退預設文字
- 使用者選擇無效日期區間（結束日早於開始日）時應提示
- 欄位數值非法時應顯示錯誤訊息
