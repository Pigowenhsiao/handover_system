# 電子交接本系統功能規格 (Electronic Handover System Feature Specification)

## 1. 功能概述 (Overview)

電子交接本系統是一個支援多語言的桌面應用程式，旨在數位化取代傳統的紙本交接日報表。系統讓使用者能夠填寫、管理並查詢每日工作報表，支援日文、中文和英文三種語言界面。此系統包含使用者管理、日報表填寫、出勤記錄、設備異常記錄、異常批次追蹤等功能。

## 2. 使用者場景與測試 (User Scenarios & Testing)

### 主要場景
- **場景1**: 使用者登入系統並選擇語言
  - 使用者進入系統後，可在介面的顯著位置找到語言選擇功能
  - 使用者選擇所需語言後，介面立即切換為該語言
  - 所有表頭、按鈕、標籤、提示訊息等都以選定語言顯示

- **場景2**: 使用者填寫日報表
  - 使用者點擊「填寫日報」按鈕
  - 在日報表界面輸入日期、班別和區域
  - 填寫 Key Output、Issues 和 Countermeasures
  - 在出勤記錄部分同時記錄正社員和契約社員（定員、出勤、欠勤、理由）
  - 在設備異常記錄部分記錄設備號碼、異常內容、發生時刻、影響數量、對應內容
  - 在異常批次記錄部分記錄批號、異常內容、處置狀況、特記事項
  - 點擊「保存」按鈕

- **場景3**: 使用者查詢歷史報表
  - 使用者點擊「報表查詢」按鈕
  - 設定查詢條件（日期範圍、區域等）
  - 查看查詢結果
  - 點擊特定報表查看詳細信息

- **場景4**: 管理員管理使用者
  - 管理員登入系統後點擊「使用者管理」按鈕
  - 在使用者管理界面新增、修改或刪除使用者帳戶
  - 點擊「保存」或「取消」按鈕

### 測試案例
- 語言：三種語言（日文、中文、英文）均可選，選後所有介面文字立即切換且不丟失當前操作
- 多語言覆蓋率：界面元素（表頭、按鈕、標籤、提示、狀態文字）均顯示完整語言名稱（日本語/中文/English）
- 出勤：同頁同時輸入正社員與契約社員的出勤/欠勤/理由，驗證出勤+欠勤≤定員
- 日報表：建立後可查詢、回填並顯示所有欄位，含設備與批次異常記錄
- 權限：一般使用者無法開啟使用者管理；管理員可新增/修改/刪除帳戶並記錄操作

## 3. 功能需求 (Functional Requirements)

### FR1: 語言選擇功能
- 系統應提供語言選擇介面元素（如下拉選單或按鈕）
- 語言選擇功能應在所有頁面的顯著位置可用
- 系統應支援三種語言：日文、中文、英文
- 系統應使用完整語言名稱（日本語、中文、English）而非代碼（JA、ZH、EN）
- 當使用者選擇不同語言時，介面應立即更新為所選語言
- 語言偏好應在使用者會話期間保持一致
- 語言偏好應存儲在瀏覽器的本地存儲 (localStorage) 中，以便在多個會話之間保持選擇

### FR2: 使用者認證功能
- 系統應提供使用者登入介面並驗證帳號密碼
- 密碼應使用安全哈希（如 bcrypt）儲存並驗證
- 系統應支援角色（管理員、一般使用者）並據此限制權限
- 僅管理員可存取使用者管理相關功能

### FR3: 日報表功能
- 系統應允許使用者建立新的日報表
- 日報表應包含日期、班別（白班/夜班）、區域（etching_D, etching_E, litho, thin_film）
- 日報表應包含 Key Machine Output、Key Issues、Countermeasures 的摘要欄位
- 系統應允許使用者編輯和保存日報表
- 系統應支援查詢和查看歷史日報表

### FR4: 出勤記錄功能
- 系統應同時記錄正社員和契約社員的出勤資料
- 每個職類別應包含定員、出勤、欠勤、理由欄位
- 系統應提供輸入介面讓使用者填寫上述資料
- 系統應驗證出勤與欠勤總數不超過定員數（除非有特殊情況）

### FR5: 設備異常記錄功能
- 系統應記錄設備號碼、異常內容、發生時刻
- 系統應記錄影響數量和對應內容
- 系統應支援圖片上傳功能
- 異常記錄應與日報表關聯

### FR6: 異常批次記錄功能
- 系統應記錄批號、異常內容、處置狀況
- 系統應支援特記事項欄位
- 批次記錄應與日報表關聯

### FR7: 使用者管理功能
- 系統應提供管理員介面來管理使用者帳戶
- 管理員應能新增、修改、刪除使用者帳戶
- 系統應驗證使用者名稱的唯一性
- 系統應安全地處理和存儲密碼

## 4. 非功能性需求 (Non-Functional Requirements)

### NFR1: 效能 (Performance)
- 語言切換響應時間應小於 500 毫秒
- 日報表保存和加載時間應小於 1 秒
- 系統應支援最多 10,000 筆日報表記錄

### NFR2: 可用性 (Usability)
- 語言選擇介面應清楚顯示可用的語言選項
- 用戶應能輕鬆辨別當前選擇的語言
- 所有翻譯標示應符合當地語言習慣
- 界面應直觀易用，使用者無需額外培訓即可操作

### NFR3: 可靠性 (Reliability)
- 語言切換功能應穩定可靠
- 不應因語言切換而出現錯誤或崩潰
- 缺少翻譯的標示應正確回退到默認語言
- 系統應確保數據一致性

### NFR4: 安全性 (Security)
- 使用者密碼應使用安全的哈希算法（如 bcrypt）進行存儲
- 只有具有適當權限的使用者才能存取管理功能
- 所有使用者管理操作都應記錄日誌

## 5. 成功標準 (Success Criteria)

- [ ] 語言切換後 500 毫秒內完成並保持選擇語言，界面標示 95% 以上正確轉換
- [ ] 語言選擇器與狀態顯示使用完整語言名稱（日本語/中文/English），不出現語言代碼
- [ ] 所有界面元素（按鈕、標題、表單等）均有對應三語翻譯，缺漏時回退默認語言
- [ ] 使用者可在 30 秒內完成日報表填寫流程（含出勤、設備異常、批次異常）
- [ ] 出勤頁面同時呈現正社員與契約社員欄位，並在驗證失敗時提供明確錯誤訊息
- [ ] 管理員可在 3 次點擊內進入使用者管理，新增/修改/刪除操作回應時間小於 2 秒

## 6. 關鍵實體 (Key Entities)

- **使用者 (User)**：包含 ID、使用者名稱、密碼哈希、角色、創建時間、更新時間等屬性
- **日報表 (Daily Report)**：包含 ID、日期、班別、區域、作者 ID、摘要內容等屬性
- **出勤記錄 (Attendance Record)**：包含 ID、報表 ID、職類別、定員數、出勤數、欠勤數、原因等屬性
- **設備異常記錄 (Equipment Log)**：包含 ID、報表 ID、設備號碼、描述、發生時間、影響數量、對應內容等屬性
- **異常批次記錄 (Lot Log)**：包含 ID、報表 ID、批號、描述、狀態、備註等屬性

## 7. 依賴與假設 (Dependencies & Assumptions)

### 依賴
- 系統現有的使用者認證機制
- SQLite 資料庫系統（單機部署，資料庫與應用程式同機執行）
- Python 環境（3.9 或更高版本）

### 假設
- 使用者熟悉基本的電腦操作
- 系統將作為桌面應用程式運行
- 網路連線不是必需的（系統可離線運行）

## 8. 邊緣案例 (Edge Cases)

- 當系統缺少特定語言的翻譯時，應正確回退到默認語言內容
- 當瀏覽器語言設置與系統支持語言不匹配時，系統應使用默認語言（日文）
- 在低頻寬環境下，語言資源加載可能延遲，系統應提供適當的加載指示
- 當翻譯文字過長導致界面元件尺寸不足時，應妥善處理文字顯示
- 當使用者試圖刪除最後一個管理員帳戶時，系統應阻止此操作

## 9. 已釐清問題 (Clarifications)

### 2025-11-25 會議決議
- **Q**: 密碼應該使用什麼加密方式？
  - **A**: 使用 bcrypt 進行密碼哈希，確保用戶帳戶安全性
- **Q**: 語言資源文件應採用何種結構？
  - **A**: 採用巢狀結構（JSON物件巢套），使翻譯資源組織更清晰
- **Q**: 界面標示的本地化如何處理？
  - **A**: 所有界面標示應從相應的語言資源檔中動態載入，並支援即時更新
- **Q**: 數據驗證應達到什麼級別？
  - **A**: 必須符合邏輯（出勤+缺勤≤定員），這是基本數據完整性要求
- **Q**: 介面設計應如何處理？
  - **A**: 保持與現有介面設計風格一致，確保用戶體驗的連續性
