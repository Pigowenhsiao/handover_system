# 引き継ぎシステム（デスクトップ版） V 0.1.4

Tkinter で作成した単機版引き継ぎシステムです。日報入力、出勤、設備異常、異常ロット、出勤統計と履歴照会に対応し、Delay List と Summary Actual のインポート/アップロードも提供します。システムは単機運用（前後端 API なし）で、データは本機の SQLite に保存します。

## 主な機能
- 多言語インターフェース：ログイン画面と各ページで日/中/英を即時切替。
- テーマ切替：ライト/ダークを即時切替、設定を保存。
- 日報入力：日付/シフト/エリアは日付選択とドロップダウンを使用。基本情報保存後に他機能が解放。同一 日付+シフト+エリア は同一日報として上書き。
- 出勤記録：正社員/契約社員の定員・出勤・欠勤・理由を同ページで入力し、当該日報に保存。
- 設備異常/異常ロット：複数記録を追加でき、日報に紐づけて保存。
- 出勤統計：出勤統計表 + 出勤率折線図 + 出勤人数の積み上げ棒グラフ。期間は当月1日〜本日が既定。
- 異常履歴照会：設備異常と異常ロットの二表で検索。日付範囲とシフト/エリアで絞り込み。
- Delay List / Summary Actual：Excel インポート → 仮保存 → アップロード。日付範囲で検索・編集。
- 管理：ユーザー/翻訳/シフト/エリア管理。システム設定でバックアップ間隔を保存。

## 使用方式
1. 安裝依賴：`pip install -r requirements.txt`
2. 啟動（建議現代化介面）：`python handover_system.py`
3. 介面啟動後，登入前可先選擇語言；登入後在各分頁填寫日報、匯入/上傳報表或管理使用者與選項。

直接モダン UI を起動（依存チェックなし）：`python start_modern_ui.py`

## 注意事項
- Excel のインポートは「インポート → 仮保存 → アップロード」方式で、アップロード前は SQLite に書き込みません。
- 同一 日付+シフト+エリア の日報は上書きされます。設備/ロット異常は同日報内で加算保存されます。
- SQLite DB は `data/handover_system.db`。初期化したい場合はバックアップ後に削除して再起動してください。
- システム設定は `handover_settings.json` に保存されます。
- Pillow は旧版 UI の画像機能のみ必要です。未使用なら不要です。

## 実行ファイル化
PyInstaller の固定設定を使用：`pyinstaller handover_modern.spec`

## 更新內容
- 出勤率表新增右鍵刪除（標示為不顯示）並寫入刪除紀錄。
- 標示為不顯示的出勤率資料不納入統計，重複輸入同日期/班別/區域會自動恢復顯示。
- Summary Actual 匯入支援工作表選擇，且全數為 0 的列不匯入。
- Delay List 與 Summary Actual 表格右鍵刪除功能已恢復。
