# 交接系統（桌面版） v2.2

Tkinter 製作的單機交接系統，支援中/英/日語切換，包含日報填寫、出勤、設備異常、異常批次、總結統計與歷史查詢，並提供 Delay List 與 Summary Actual 匯入/上傳。系統為單機版（無前後端 API），資料儲存在本機 SQLite。

## 主要功能
- 多語言介面：登入與各頁面可即時切換中/英/日。
- 日報填寫：日期/班別/區域採日期選擇器與下拉選單；需先儲存基本資訊後才能操作其他功能；同日期+班別+區域會覆寫同一筆日報。
- 出勤記錄：同頁輸入正職/契約定員、出勤、欠勤與理由，並保存到當前日報。
- 設備異常/批次異常：可新增多筆記錄，與日報關聯保存。
- 總結統計：出勤統計表 + 出勤率折線圖 + 出勤人數堆疊柱狀圖；日期區間預設當月 1 號到今天。
- 異常歷史查詢：設備異常與異常批次雙表格查詢，支援日期區間與班別/區域篩選。
- Delay List / Summary Actual：Excel 匯入 → 暫存 → 上傳流程；可依日期範圍查詢與編輯。
- 管理：使用者/翻譯/班別/區域管理；系統設定可儲存備份間隔。

## 使用方式
1. 安裝依賴：`pip install -r requirements.txt`
2. 啟動（建議現代化介面）：`python run_modern_system.py`
3. 介面啟動後，登入前可先選擇語言；登入後在各分頁填寫日報、匯入/上傳報表或管理使用者與選項。

如需直接啟動現代化介面（不含依賴檢查）：`python start_modern_ui.py`

## 注意與限制
- Excel 匯入採「匯入 -> 暫存 -> 上傳」流程，未上傳不會寫入 SQLite。
- 同日期+班別+區域的日報會覆寫同一筆資料；設備/批次異常記錄維持累加。
- 系統使用 SQLite `handover_system.db`；如需重置，可備份或刪除該檔後重新啟動讓程式初始化。
- 系統設定保存在 `handover_settings.json`。
- Pillow 僅在舊版介面的圖片功能需要；若不使用該功能可不安裝。
